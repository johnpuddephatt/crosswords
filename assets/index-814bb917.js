var De=Object.defineProperty;var Ue=(t,e,n)=>e in t?De(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var L=(t,e,n)=>(Ue(t,typeof e!="symbol"?e+"":e,n),n),re=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var u=(t,e,n)=>(re(t,e,"read from private field"),n?n.call(t):e.get(t)),h=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},S=(t,e,n,r)=>(re(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var C=(t,e,n)=>(re(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();function x(t,e){t.classList.add(e)}function Ce(t,e){e.forEach(n=>{t.classList.add(n)})}function a(t,e){if(!t)throw new Error(e||"Assertion failed")}const je=(t,e=document)=>e.getElementById(t),Pe=(t,e=document)=>e.getElementsByClassName(t);function qe(t){return t?t[0]:null}function Be(t,e,n){let r=t;if(t&&e!=null&&n){let s=parseInt(e,10);s<0&&(s=t.length+s),s>=0&&n&&t.length>s&&(r=`${t.slice(0,s)}${n}${t.slice(s+n.length)}`)}return r}const Ve=t=>{const e="id_Z?7kQ;x8j!",n={};return r=>(r[e]||(r[e]=Math.random().toString(16).slice(2)),r[e]in n||(n[r[e]]=t(r),y(`memoize:caching id ${r[e]}`)),n[r[e]])};function V(t,e){t.classList.remove(e)}function U(t,e,n){let r=t??"";return r=r.padEnd(e+1," "),Be(r,e,n)}const y=t=>{},Fe=()=>{const t={},e=t.hasOwnProperty;return{publish:(n,r)=>{e.call(t,n)&&t[n].forEach(s=>{s(r!==void 0?r:{})})},subscribe:(n,r)=>{e.call(t,n)||(t[n]=[]);const s=t[n].push(r)-1;return{remove:()=>{delete t[n][s]}}}}};function Ke(t){const e={};for(const n of t)e[n]=n;return Object.freeze(e)}const ge=/^(.*?)\.(.*)\((.*?)\)$/,fe=/^(\d+[ad]?)(,(\d+[ad]?.*))*$/,We=/^\s*(.*?)\s*$/,we=/^(\d+)(([,-])(\d+.*))*$/,Ze="<NumberText>.<ClueText>(<AnswerText>)";function ze(t){const e={x:1,y:1,clue:"1. Clue (1)"},n={answer:"",solution:"",revealed:""},r=Object.keys(e),s=Object.keys(n),l=Object.keys(t);for(const o of r)if(!l.includes(o))throw new Error(`'cdClue.${o}' is missing`);for(const o of r)if(typeof e[o]!=typeof t[o])throw new Error(`'cdClue.${o} (${t[o]})' must be a ${typeof e[o]}`);for(const o of s)if(l.includes(o)&&typeof n[o]!=typeof t[o])throw new Error(`'cdClue.${o} (${t[o]})' must be a ${typeof n[o]}`);const i=new Set(l);for(const o of r)i.delete(o);for(const o of s)i.delete(o);if(i.size>0)throw new Error(`'cdClue' has unexpected properties <${[...i].join(",")}>`);if(!ge.test(t.clue))throw new Error(`Clue '${t.clue}' does not match the required pattern '${Ze}'`)}function Je(t,e){if(t===void 0||e===void 0)throw new Error("'cdClue' and 'isAcrossClue' are required");if(t===null)throw new Error("'cdClue' can't be null");if(e===null)throw new Error("'isAcrossClue' can't be null");if(typeof e!="boolean")throw new Error("'isAcrossClue' must be a boolean (true,false)")}function Ye(t,e){let n=t,r=[];for(;fe.test(n);){const[,s,,l]=fe.exec(n);r.push(s),n=l}if(n!=null)throw new Error(`'${e.clue}' Error in <numberText> near <${n}>`);return r}function Qe(t){function e(s){return s.endsWith("a")?"across":s.endsWith("d")?"down":null}let n=t.slice(1),r=[];return n&&(r=n.map(s=>({number:parseInt(s,10),direction:e(s)}))),r}function _e(t,e){let n=[],r=t;for(;we.test(r);){const[,s,,l,i]=we.exec(r);n.push({length:parseInt(s,10),terminator:l??""}),r=i}if(r!=null)throw new Error(`'${e.clue}' Error in <answerText> near <${r}>`);return n}function Xe(t,e){Je(t,e),ze(t);const n=t.x-1,r=t.y-1,s=e,l=[],i=t.solution?t.solution.toUpperCase().replaceAll(/[^A-Z]/g,""):void 0,o=t.revealed?t.revealed.toUpperCase():void 0,[,d,w,p]=ge.exec(t.clue),g=Ye(d,t),f=Qe(g),c=qe(g),T=parseInt(c,10),ne=T.toString(),Re=c.endsWith("a")||c.endsWith("d")?c:c+(e?"a":"d"),[,Ne]=We.exec(w),ae=_e(p,t),H=ae.reduce((Me,Ge)=>Me+Ge.length,0),He=t.answer?t.answer.toUpperCase().replaceAll(/[^ A-Z]/g," ").padEnd(H):"".padEnd(H),he=`(${p})`;if(i&&i.length!==H)throw new Error(`Length of clue solution '${i}' does not match the answer length '${he}'`);if(o&&o.length!==H)throw new Error(`Length of clue revealed characters '${o}' does not match the answer length: ${H}`);return{answer:He,answerLength:H,answerLengthText:he,answerSegments:ae,cells:l,clueLabel:ne,clueText:Ne,code:Re,connectedDirectedClues:f,isAcross:s,number:T,revealed:o,solution:i,x:n,y:r}}function et(t){const{width:e}=t,{height:n}=t,r=new Array(e);for(let s=0;s<e;s+=1){r[s]=new Array(n);for(let l=0;l<n;l+=1)r[s][l]={model:t,x:s,y:l}}return r}function tt(t,e){let n=e;for(const r of t){if(n<=r.length)return[r,n];n-=r.length}return null}function nt(t){let e={width:t.width,height:t.height,acrossClues:[],downClues:[],cells:[]};if(e.width===void 0||e.width===null||e.width<0||e.height===void 0||e.height===null||e.height<0)throw new Error("The crossword bounds are invalid.");return e}function rt(t,e,n){if(t.x<0||t.x>=e.width||t.y<0||t.y>=e.height)throw new Error(`Clue ${t.code} doesn't start in the bounds.`);if(n){if(t.x+t.answerLength>e.width)throw new Error(`Clue ${t.code} exceeds horizontal bounds.`)}else if(t.y+t.answerLength>e.height)throw new Error(`Clue ${t.code} exceeds vertical bounds.`)}function st(t,e,n){!n&&t.acrossClue&&(t.acrossClue.answer=U(t.acrossClue.answer,t.acrossClueLetterIndex,e)),n&&t.downClue&&(t.downClue.answer=U(t.downClue.answer,t.downClueLetterIndex,e))}function ot(t){if(!t)throw new Error("The model must be initialised with a JSON crossword definition.");let e=nt(t);e.cells=et(e);const n=t.acrossClues.concat(t.downClues);for(let s=0;s<n.length;s+=1){const l=n[s],i=s<t.acrossClues.length,o=Xe(l,i);e[i?"acrossClues":"downClues"].push(o),rt(o,e,i);let{x:d,y:w}=o;const p=" ",g=" ";for(let f=0;f<o.answerLength;f+=1){const c=e.cells[d][w];c.light=!0,c[i?"acrossClue":"downClue"]=o,c[i?"acrossClueLetterIndex":"downClueLetterIndex"]=f,o.cells.push(c);const[T,ne]=tt(o.answerSegments,f);if(ne===T.length-1&&T.terminator!==""&&(c[o.isAcross?"acrossTerminator":"downTerminator"]=T.terminator),l.answer){if(c.answer&&c.answer!==p&&c.answer!==o.answer[f])throw new Error(`Clue ${o.code} answer at (${d+1},${w+1}) [${o.answer}[${f+1}],${o.answer[f]}] is not coherent with previous clue (${c.acrossClue.code}) answer [${c.acrossClue.answer},${c.answer}].`);c.answer=o.answer[f],st(c,c.answer,i)}else c.answer||(c.answer=p);if(l.solution){if(c.solution&&c.solution!==g&&c.solution!==o.solution[f])throw new Error(`Clue ${o.code} solution at (${d+1},${w+1}) [${o.solution}[${f+1}],${o.solution[f]}] is not coherent with previous clue (${c.acrossClue.code}) solution [${c.acrossClue.solution},${c.solution}].`);c.solution=o.solution[f]}else c.solution=g;if(f===0){if(c.clueLabel&&c.clueLabel!==o.number)throw new Error(`Clue ${o.code} has a label which is inconsistent with another clue (${c.acrossClue.code}).`);c.clueLabel=o.number}i?d+=1:w+=1}}return e.acrossClues.concat(e.downClues).forEach(s=>{if(!s.connectedDirectedClues)return;s.connectedClues=s.connectedDirectedClues.map(o=>o.direction==="across"?e.acrossClues.find(d=>d.number===o.number):o.direction==="down"?e.downClues.find(d=>d.number===o.number):e.acrossClues.find(d=>d.number===o.number)||e.downClues.find(d=>d.number===o.number)),s.answerLengthText=`(${[s.answerLengthText].concat(s.connectedClues.map(o=>o.answerLengthText)).join(",").replace(/[()]/g,"")})`;let l=0;const i=[s].concat(s.connectedClues);i.forEach(o=>{l>0&&(o.previousClueSegment=i[l-1]),l<i.length-1&&(o.nextClueSegment=i[l+1]),[o.parentClue]=i,l+=1}),s.clueLabel=`${[s.number].concat(s.connectedClues.map(o=>o.number)).join(",")}.`,s.connectedClues.forEach(o=>{o.answerLengthText=null,o.isConnectedClue=!0})}),e}var $;class lt{constructor(){h(this,$,void 0);S(this,$,[])}add(e,n){u(this,$).push({cell:e,cellElement:n})}getCellElement(e){const n=u(this,$).find(r=>r.cell===e);return n?n.cellElement:null}getCell(e){const n=u(this,$).find(r=>r.cellElement===e);return n?n.cell:null}removeCrosswordCells(e){S(this,$,u(this,$).filter(n=>n.cell.crossword!==e))}}$=new WeakMap;const M=t=>{t&&t.classList.add("hidden")},Ee=t=>{t&&t.classList.remove("hidden")},me=Ve(t=>t.filter(e=>!e.previousClueSegment));function ie(t,e){a(t,"<controller> is null or undefined"),a(e,"<cell> is null or undefined");const n=e.acrossClue?e.acrossClue:e.downClue,r=e.acrossClue?e.acrossClueLetterIndex:e.downClueLetterIndex,s=n.solution[r];ue(t,e,s,!1),Ee(t.revealedElement(e)),M(t.incorrectElement(e))}function it(t,e){a(t,"<controller> is null or undefined"),a(e,"<clue> is null or undefined"),y(`revealClue: '${e.code}'`),(e.parentClue?[e.parentClue].concat(e.parentClue.connectedClues):[e]).forEach(r=>{r.cells.forEach(s=>{ie(t,s)})})}function ut(t){a(t,"<controller> is null or undefined"),t.crosswordModel.cells.forEach(e=>{e.filter(n=>n.light).forEach(n=>{ie(t,n)})})}const m=Ke(["Correct","Incorrect","Incomplete"]);function te(t,e,n=!0){a(t,"<controller> is null or undefined"),a(e,"<cell> is null or undefined");const[r,s]=e.acrossClue?[e.acrossClue,e.acrossClueLetterIndex]:[e.downClue,e.downClueLetterIndex],l=r.answer[s],i=r.solution[s],o=l===i?m.Correct:l===" "||l===void 0?m.Incomplete:m.Incorrect;return o===m.Incorrect&&n&&Ee(t.incorrectElement(e)),o}function ct(t,e,n=!0){a(t,"<controller> is null or undefined"),a(e,"<clue> is null or undefined"),y(`testClue: '${e.code}'`);let r=0,s=0;return(e.parentClue?[e.parentClue].concat(e.parentClue.connectedClues):[e]).forEach(i=>{i.cells.forEach(o=>{const d=te(t,o,n);d===m.Incorrect?r+=1:d===m.Incomplete&&(s+=1)})}),r>0?m.Incorrect:s>0?m.Incomplete:m.Correct}function dt(t,e=!0){a(t,"<controller> is null or undefined");let n=0,r=0;return t.crosswordModel.cells.forEach(s=>{s.filter(l=>l.light).forEach(l=>{const i=te(t,l,e);i===m.Incorrect?n+=1:i===m.Incomplete&&(r+=1)})}),n>0?m.Incorrect:r>0?m.Incomplete:m.Correct}function at(t){a(t,"<controller> is null or undefined");let e=0,n=0;const r=!1;return t.crosswordModel.cells.find(s=>s.filter(l=>l.light).find(l=>{const i=te(t,l,r);if(i===m.Incorrect)return e=1,!0;if(i===m.Incomplete)return n=1,!0})),e>0?m.Incorrect:n>0?m.Incomplete:m.Correct}function ue(t,e,n,r){a(e&&(e.acrossClue||e.downClue),"setCellText: cell is null or not part of a clue");function s(l,i){let o=l;return o.answer=U(o.answer,i,n),r&&(o.revealed=U(o.revealed,i,n)),o}if(e.acrossClue){let l=e.acrossClue;const i=e.acrossClueLetterIndex;l=s(l,i)}if(e.downClue){let l=e.downClue;const i=e.downClueLetterIndex;l=s(l,i)}t.inputElement(e).value=n}function xe(t,e){a(t,"<controller> is null or undefined"),a(e,"<cell> is null or undefined"),ue(t,e," ",!0),M(t.incorrectElement(e))}function ht(t,e){a(t,"<controller> is null or undefined"),a(e,"<clue> is null or undefined"),y(`resetClue: '${e.code}'`),(e.parentClue?[e.parentClue].concat(e.parentClue.connectedClues):[e]).forEach(r=>{r.cells.forEach(s=>{xe(t,s)})})}function Ct(t){a(t,"<controller> is null or undefined"),t.crosswordModel.cells.forEach(e=>{e.filter(n=>n.light).forEach(n=>{xe(t,n)})})}function ve(t,e){a(t,"<controller> is null or undefined"),a(e,"<cell> is null or undefined");const n=te(t,e)===m.Incorrect;n&&(ue(t,e," ",n),M(t.incorrectElement(e)))}function ft(t,e){a(t,"<controller> is null or undefined"),a(e,"<clue> is null or undefined"),y(`cleanClue: '${e.code}'`),(e.parentClue?[e.parentClue].concat(e.parentClue.connectedClues):[e]).forEach(r=>{r.cells.forEach(s=>{ve(t,s)})})}function wt(t){a(t,"<controller> is null or undefined"),t.crosswordModel.cells.forEach(e=>{e.filter(n=>n.light).forEach(n=>{ve(t,n)})})}function pe(t,e){const n=e.acrossClue&&e.downClue;return n&&(t.currentClue=e.acrossClue===t.currentClue?e.downClue:e.acrossClue),n}function be(t,e){const n=t.currentClue,l=(e.acrossClue===n?e.acrossClueLetterIndex:e.downClueLetterIndex)+1===n.cells.length&&n.nextClueSegment;return l&&(t.currentClue=n.nextClueSegment),l}function ye(t,e){const n=t.currentClue,l=(e.acrossClue===n?e.acrossClueLetterIndex:e.downClueLetterIndex)-1===-1&&n.previousClueSegment;return l&&(t.currentCell=last(n.previousClueSegment.cells)),l}function mt(t,e){const{x:n,y:r}=e,{height:s}=e.model;let l=!1;return e.y+1<s&&e.model.cells[n][r+1].light===!0?(t.currentCell=e.model.cells[n][r+1],l=!0):l=be(t,e),l}function pt(t,e){const{x:n,y:r}=e,{width:s}=e.model;let l=!1;return e.x+1<s&&e.model.cells[n+1][r].light===!0?(t.currentCell=e.model.cells[n+1][r],l=!0):l=be(t,e),l}function gt(t,e){const{x:n,y:r}=e;let s=!1;return e.y>0&&e.model.cells[n][r-1].light===!0?(t.currentCell=e.model.cells[n][r-1],s=!0):s=ye(t,e),s}function Et(t,e){const{x:n,y:r}=e;let s=!1;return e.x>0&&e.model.cells[n-1][r].light===!0?(t.currentCell=e.model.cells[n-1][r],s=!0):s=ye(t,e),s}function se(t,e,n){const r=t.cell(e.target.parentNode);e.target.value=n,r.acrossClue&&(r.acrossClue.answer=U(r.acrossClue.answer,r.acrossClueLetterIndex,n)),r.downClue&&(r.downClue.answer=U(r.downClue.answer,r.downClueLetterIndex,n))}const xt=8,vt=9,bt=13,yt=37,Lt=38,It=39,St=40,$t=46,Tt=/^[A-Z]$/,At=/^[ A-Z]$/,oe=5;var A,b,P,q,k,G,I,O,B,R,K,N,j,le,Ot,W,Z,Le,E,v,D,F,z,Ie,J,Se,Y,$e,Q,Te,_,Ae,X,ke,ee,Oe;class kt{constructor(e,n,r){h(this,N);h(this,le);h(this,Z);h(this,E);h(this,D);h(this,z);h(this,J);h(this,Y);h(this,Q);h(this,_);h(this,X);h(this,ee);h(this,A,new lt);h(this,b,{clue:null,cell:null});h(this,P,Fe());h(this,q,[]);h(this,k,void 0);h(this,G,void 0);h(this,I,void 0);h(this,O,void 0);h(this,B,void 0);h(this,R,void 0);h(this,K,["cellRevealed","clueCleaned","clueReset","clueRevealed","clueSelected","clueSolved","clueTested","crosswordCleaned","crosswordReset","crosswordRevealed","crosswordSolved","crosswordTested"]);L(this,"cell",e=>u(this,A).getCell(e));L(this,"cellElement",e=>u(this,A).getCellElement(e));L(this,"inputElement",e=>this.cellElement(e).children[0]);L(this,"revealedElement",e=>{const n=e.clueLabel?2:1;return this.cellElement(e).children[n]});L(this,"incorrectElement",e=>{const n=e.clueLabel?3:2;return this.cellElement(e).children[n]});L(this,"bindEventHandlerToId",(function(e,n="click",r=document){const s=je(e,r);s&&s.addEventListener(n,this.userEventHandler(e))}).bind(this));L(this,"bindEventHandlersToIds",(function(e=this.userEventHandlerIds,n="click",r=document){e.forEach(s=>{this.bindEventHandlerToId(s,n,r)})}).bind(this));L(this,"bindEventHandlerToClass",(function(e,n="click",r=document){Pe(e,r).forEach(l=>{l.addEventListener(n,this.userEventHandler(e))})}).bind(this));L(this,"bindEventHandlersToClass",(function(e=this.userEventHandlerIds,n="click",r=document){e.forEach(s=>this.bindEventHandlerToClass(s,n,r))}).bind(this));h(this,W,(e,n)=>{e.forEach(r=>{a(this.controllerEventNames.includes(r),`addEventsListener: event [${r}] is not a CrosswordController event.`),u(this,q).push(u(this,P).subscribe(r,n))})});a(e,"CrosswordController: crosswordModel is null or undefined"),a(n,"CrosswordController: domGridParentElement is null or undefined"),S(this,I,e),S(this,O,n),S(this,B,r),S(this,k,u(this,N,j).createElement("div")),x(u(this,k),"crossword-grid"),r&&(S(this,G,C(this,z,Ie).call(this,u(this,N,j),this)),r.appendChild(u(this,G)));for(let s=0;s<u(this,I).height;s+=1)for(let l=0;l<u(this,I).width;l+=1){const i=u(this,I).cells[l][s],o=C(this,Y,$e).call(this,u(this,N,j),i);u(this,k).appendChild(o),u(this,A).add(i,o)}S(this,R,{"reveal-cell":this.revealCurrentCell,"clean-clue":this.cleanCurrentClue,"reset-clue":this.resetCurrentClue,"reveal-clue":this.revealCurrentClue,"test-clue":this.testCurrentClue,"clean-crossword":this.cleanCrossword,"reset-crossword":this.resetCrossword,"reveal-crossword":this.revealCrossword,"test-crossword":this.testCrossword}),u(this,O).appendChild(this.crosswordGridView),this.currentClue=u(this,I).acrossClues[0]}destroy(){u(this,A).removeCrosswordCells(u(this,I)),u(this,O).removeChild(this.crosswordGridView),u(this,B).removeChild(this.crosswordCluesView),u(this,q).forEach(e=>{e.remove()})}userEventHandler(e){return a(u(this,R).hasOwnProperty(e),`userEventHandler: [${e}] is not a CrosswordController event handler.`),u(this,R)[e].bind(this)}get userEventHandlerIds(){return Object.keys(u(this,R))}get currentCell(){return u(this,b).cell}set currentCell(e){y(`set currentCell: (${e.x},${e.y})`),e!==u(this,b).cell&&(u(this,b).cell&&C(this,ee,Oe).call(this,u(this,b).cell),u(this,b).cell=e,e==null||e.cellElement.children[0].focus(),C(this,X,ke).call(this,e))}get currentClue(){return u(this,b).clue}set currentClue(e){e!==u(this,b).clue&&(u(this,b).clue&&C(this,_,Ae).call(this,u(this,b).clue),y(`set currentClue: '${e.code}'`),u(this,b).clue=e,C(this,Q,Te).call(this,e),this.currentClue.cells.includes(this.currentCell)||(this.currentCell=this.currentClue.cells[0]),C(this,E,v).call(this,"clueSelected",e))}get crosswordModel(){return u(this,I)}get addEventsListener(){return u(this,W)}get crosswordGridView(){return u(this,k)}get crosswordCluesView(){return u(this,G)}get controllerEventNames(){return u(this,K)}testCurrentClue(){y(`testCurrentClue:${this.currentClue.code}`);const e=!0,n=ct(this,this.currentClue,e);return C(this,E,v).call(this,"clueTested",n),n===m.Correct&&setTimeout(()=>{C(this,E,v).call(this,"clueSolved",this.currentClue)},oe),n}testCrossword(){const n=dt(this,!0);return C(this,E,v).call(this,"crosswordTested",n),n===m.Correct&&setTimeout(()=>{C(this,E,v).call(this,"crosswordSolved",this.crosswordModel)},oe),n}revealCurrentCell(){ie(this,this.currentCell),C(this,E,v).call(this,"cellRevealed",this.currentCell),C(this,D,F).call(this)}revealCurrentClue(){it(this,this.currentClue),C(this,E,v).call(this,"clueRevealed",this.currentClue),C(this,D,F).call(this)}revealCrossword(){ut(this),C(this,E,v).call(this,"crosswordRevealed",this.crosswordModel)}resetCurrentClue(){ht(this,this.currentClue),C(this,E,v).call(this,"clueReset",this.currentClue)}resetCrossword(){Ct(this),C(this,E,v).call(this,"crosswordReset",this.crosswordModel)}cleanCurrentClue(){ft(this,this.currentClue),C(this,E,v).call(this,"clueCleaned",this.currentClue)}cleanCrossword(){wt(this),C(this,E,v).call(this,"crosswordCleaned",this.crosswordModel)}}A=new WeakMap,b=new WeakMap,P=new WeakMap,q=new WeakMap,k=new WeakMap,G=new WeakMap,I=new WeakMap,O=new WeakMap,B=new WeakMap,R=new WeakMap,K=new WeakMap,N=new WeakSet,j=function(){return u(this,O).ownerDocument},le=new WeakSet,Ot=function(){return u(this,N,j).defaultView},W=new WeakMap,Z=new WeakSet,Le=function(e){const n=e.acrossClue,r=e.downClue,s=this.currentClue;return this.currentClue&&(this.currentClue===n||this.currentClue===r)||(n&&!r||!n&&r?(this.currentClue=n||r,this.currentClue):n&&this.currentClue&&(n===this.currentClue.previousClueSegment||n===this.nextClueSegment)?this.currentClue=n:r&&this.currentClue&&(r===this.currentClue.previousClueSegment||r===this.nextClueSegment)?this.currentClue=r:(this.currentClue=e.downClueLetterIndex===0&&e.acrossClueLetterIndex!==0?r:n,this.currentClue)),this.currentClue!==s},E=new WeakSet,v=function(e,n){u(this,P).publish(e,n)},D=new WeakSet,F=function(){at(this)===m.Correct&&setTimeout(()=>{C(this,E,v).call(this,"crosswordSolved",this.crosswordModel)},oe)},z=new WeakSet,Ie=function(e,n){a(e,"#newCrosswordCluesView: [document] is null or undefined"),a(n,"#newCrosswordCluesView: [controller] is null or undefined");function r(o,d){let w=e.createElement("div");x(w,"crossword-clue-block"),w.id=o;let p=e.createElement("p");return p.innerHTML=d,x(p,"crossword-clue-block-title"),w.appendChild(p),w}function s(o,d,w){w.forEach(p=>{let g=e.createElement("div");x(g,"crossword-clue"),g.modelClue=p;let f=e.createElement("span");x(f,"crossword-clue-label"),f.innerHTML=`${p.clueLabel}`,g.appendChild(f);let c=e.createElement("span");x(c,"crossword-clue-text"),c.innerHTML=`${p.clueText} ${p.answerLengthText}`,g.appendChild(c),g.addEventListener("click",T=>{y(`clue(${p.clueLabel}):click`),o.currentClue=p}),d.appendChild(g)})}function l(o){const d=n.currentClue;if(o===d)return!0;{const w=d==null?void 0:d.parentClue;return d&&w&&(w===o||w.connectedClues.indexOf(o)!==-1)}}let i={wrapper:e.createElement("div"),acrossClues:r("crossword-across-clues","Across"),downClues:r("crossword-down-clues","Down")};return x(i.wrapper,"crossword-clues"),s(n,i.acrossClues,n.crosswordModel.acrossClues),i.wrapper.appendChild(i.acrossClues),s(n,i.downClues,n.crosswordModel.downClues),i.wrapper.appendChild(i.downClues),n.addEventsListener(["clueSelected"],o=>{for(const d of i.acrossClues.children)l(d.modelClue)?x(d,"current-clue-segment"):V(d,"current-clue-segment");for(const d of i.downClues.children)l(d.modelClue)?x(d,"current-clue-segment"):V(d,"current-clue-segment")}),i.wrapper},J=new WeakSet,Se=function(e,n){const r=this;n.addEventListener("focus",s=>{var i;const l=r.cell(s.target.parentNode);C(i=r,Z,Le).call(i,l)&&C(this,E,v).call(this,"clueSelected",r.currentClue)}),n.addEventListener("click",s=>{const l=r.cell(s.target.parentNode);l===r.currentCell&&pe(r,l),r.currentCell=l}),e.addEventListener("keydown",s=>{y(`event:keydown keycode=${s.keyCode}`);const l=r.cell(s.target.parentNode),{model:i}=l;let o=r.currentClue;switch(s.keyCode){case xt:s.preventDefault(),se(r,s," "),M(r.incorrectElement(l));const w=(l.acrossClue===o?l.acrossClueLetterIndex:l.downClueLetterIndex)-1;w>=0?r.currentCell=o.cells[w]:w===-1&&o.previousClueSegment&&(r.currentCell=last(o.previousClueSegment.cells));break;case vt:s.preventDefault(),o.parentClue&&(o=o.parentClue);const p=o.isAcross?me(i.acrossClues):me(i.downClues);y(`tab: across (${o.isAcross}) searchClues.length (${p.length})`);let g=null;const f=p.indexOf(o);a(f!==-1,`keydown(TAB): clue '${o.code}' not found in searchClues`),s.shiftKey?f>0?g=p[f-1]:g=o.isAcross?i.downClues[i.downClues.length-1]:i.acrossClues[i.acrossClues.length-1]:f<p.length-1?g=p[f+1]:g=o.isAcross?i.downClues[0]:i.acrossClues[0],r.currentClue=g;break;case bt:s.preventDefault(),pe(r,l);break;case $t:s.preventDefault(),se(r,s," "),M(r.incorrectElement(l));break}}),e.addEventListener("keypress",s=>{s.preventDefault();const l=r.cell(s.target.parentNode),i=r.currentClue,o=String.fromCharCode(s.keyCode).toUpperCase();if(Tt.test(o)&&(se(r,s,o),M(r.incorrectElement(l)),C(this,D,F).call(this)),At.test(o)){const w=(l.acrossClue===i?l.acrossClueLetterIndex:l.downClueLetterIndex)+1;w<i.cells.length?r.currentCell=i.cells[w]:i.nextClueSegment&&(r.currentClue=i.nextClueSegment)}}),e.addEventListener("keyup",s=>{const l=r.cell(s.target.parentNode);switch(s.keyCode){case yt:Et(r,l);break;case Lt:gt(r,l);break;case It:pt(r,l);break;case St:mt(r,l);break}})},Y=new WeakSet,$e=function(e,n){const r=e.createElement("div");if(x(r,"cwcell"),n.cellElement=r,x(r,n.light?"light":"dark"),!n.light)return r;const s=e.createElement("input");if(s.maxLength=1,n.answer&&(s.value=n.answer),r.appendChild(s),n.clueLabel){const o=e.createElement("div");x(o,"cwclue-label"),o.innerHTML=n.clueLabel,r.appendChild(o)}const l=e.createElement("div");Ce(l,["cwcell-revealed","hidden"]),r.appendChild(l);const i=e.createElement("div");return Ce(i,["cwcell-incorrect","hidden"]),r.appendChild(i),",-".includes(n.acrossTerminator)?x(s,"cw-across-word-separator"):",-".includes(n.downTerminator)&&x(s,"cw-down-word-separator"),C(this,J,Se).call(this,r,s),r},Q=new WeakSet,Te=function(e){(e.parentClue?[e.parentClue].concat(e.parentClue.connectedClues):[e]).forEach(r=>{r.cells.forEach(s=>{x(this.inputElement(s),"active")})})},_=new WeakSet,Ae=function(e){(e.parentClue?[e.parentClue].concat(e.parentClue.connectedClues):[e]).forEach(r=>{r.cells.forEach(s=>{V(this.inputElement(s),"active")})})},X=new WeakSet,ke=function(e){a(e,"#highLightCell: cell is undefined"),x(this.inputElement(e),"highlighted")},ee=new WeakSet,Oe=function(e){a(e,"#deHighLightCell: cell is undefined"),V(this.inputElement(e),"highlighted")};const ce={compileCrossword:ot,Controller:kt};typeof window<"u"&&(window.CrosswordsJS=ce);document.querySelector("#app").innerHTML='<div class="crossword"></div><div class="down-clues"></div> ';let de;try{de=ce.compileCrossword({info:{source:"https://www.fifteensquared.net/2022/05/16/financial-times-17095-by-alberich/",title:"Financial Times 17,095",setter:{title:"Alberich",url:"https://www.fifteensquared.net/2022/05/16/financial-times-17095-by-alberich/"}},width:15,height:15,acrossClues:[{x:1,y:1,clue:"1. Married woman shows animosity (6)",solution:"MALICE",answer:"wotcha"},{x:8,y:1,clue:"4. One's held back by a stout grating (8)",solution:"ABRASIVE",answer:"abraXive"},{x:1,y:3,clue:"10. Out of gas, grateful for a quantity of it (7)",solution:"TANKFUL"},{x:9,y:3,clue:"11. Weapon caused injury to young woman (7)",solution:"CUTLASS"},{x:1,y:5,clue:"12. One in bar may have one for it? (4)",solution:"ROAD"},{x:6,y:5,clue:"13. Woman who suffered capital loss in Lebanon, beaten by fluctuating yen (4,6)",solution:"ANNE BOLEYN"},{x:1,y:7,clue:"15. Start as home counties solicitor (3,3)",solution:"SET OUT"},{x:8,y:7,clue:"16. Officer without company is beset by depression (7)",solution:"COLONEL"},{x:2,y:9,clue:"20. Runs into shy university teacher in London borough (7)",solution:"CROYDON"},{x:10,y:9,clue:"21. Supply outstanding artwork (6)",solution:"RELIEF"},{x:1,y:11,clue:"24. Generous Alberich awkwardly accepts thanks (10)",solution:"CHARITABLE"},{x:12,y:11,clue:"26. French bread? (4)",solution:"EURO"},{x:1,y:13,clue:"28. Sick joke finally gets girl banned (7)",solution:"ILLEGAL"},{x:9,y:13,clue:"29. Southern climate's not hot - so wear this? (7)",solution:"SWEATER"},{x:1,y:15,clue:"30. Old lady faces adversity, ignoring the odds - most impressive (8)",solution:"GRANDEST"},{x:10,y:15,clue:"31. Cheese's said to give one wind (6)",solution:"BREEZE"}],downClues:[{x:1,y:1,clue:"1. Ordered risotto after introduction to Minnie Driver (8)",solution:"MOTORIST",answer:"woctopus"},{x:3,y:1,clue:"2. City thrashed Real, having engaged new players (9)",solution:"LANCASTER"},{x:5,y:1,clue:"3. Caught university fellows with blow (4)",solution:"CUFF"},{x:9,y:1,clue:"5. He will have education to a degree (8)",solution:"BACHELOR"},{x:11,y:1,clue:"6. Scientist whose study involves moon, star and heart of asteroid? (10)",solution:"ASTRONOMER"},{x:13,y:1,clue:"7. I am taking a long time to create public persona (5)",solution:"IMAGE"},{x:15,y:1,clue:"8. Religious ascetic from German city beginning to evangelise (6)",solution:"ESSENE"},{x:7,y:2,clue:"9. Frank's lacking a point (5)",solution:"BLUNT"},{x:5,y:6,clue:"14.  Improvised explanation of unfair trial? (4-6)",solution:"JURY RIGGED"},{x:13,y:7,clue:"17.  Content of letter must follow quite ridiculous protocol (9)",solution:"ETIQUETTE"},{x:7,y:8,clue:"18.  Company moves fast across lake in rowing boats (8)",solution:"CORACLES"},{x:15,y:8,clue:"19.  Naturally I must escape from ferocious bats (2,6)",solution:"OF COURSE"},{x:1,y:10,clue:"22.  Timeless longing to find old Chinese text (1,5)",solution:"I CHING"},{x:9,y:10,clue:"23.  Rich, even when penniless? (5)",solution:"PLUSH"},{x:3,y:11,clue:"25.  Somewhat irrational loathing for Scottish town (5)",solution:"ALLOA"},{x:11,y:12,clue:"27.  A drop in rent (4)",solution:"TEAR"}]})}catch(t){console.log(`Error compiling crossword: ${t}`)}new ce.Controller(de,document.querySelector(".crossword"));de.downClues.forEach(t=>{let e=document.createElement("div");e.innerHTML=`${t.clueLabel} ${t.clueText} ${t.answerLengthText}`,document.querySelector(".down-clues").appendChild(e)});
